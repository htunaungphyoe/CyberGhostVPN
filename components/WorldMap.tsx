import React from 'react';
import type { ServerLocation, ConnectionStatus } from '../types';

interface WorldMapProps {
  servers: ServerLocation[];
  selectedServer: ServerLocation | null;
  connectionStatus: ConnectionStatus;
  onSelect: (server: ServerLocation) => void;
}

// A simplified path for the world map.
const worldPath = "M89,63L88,62L88,61L86,61L86,60L85,60L85,59L83,59L83,58L84,57L84,56L82,54L82,52L83,51L83,50L82,50L82,49L81,49L81,48L82,47L82,46L81,45L81,44L82,43L82,42L81,41L81,40L82,39L82,38L81,37L80,37L79,38L78,38L77,39L76,39L75,40L74,40L73,41L72,41L71,42L70,42L69,43L68,43L67,44L66,44L65,45L64,45L63,46L62,46L61,47L60,47L59,48L58,48L57,49L56,49L55,50L54,50L53,51L52,51L51,52L50,52L49,53L48,53L47,54L46,54L45,55L44,55L43,56L42,56L41,57L40,57L39,58L38,58L37,59L36,59L35,60L34,60L33,61L32,61L31,62L30,62L29,63L28,63L27,64L26,64L25,65L24,65L23,66L22,66L21,67L20,67L19,68L18,68L17,69L16,69L15,70L14,70L13,71L12,71L11,72L10,72L9,73L8,73L7,74L6,74L5,75L4,75L3,76L2,76L1,77L0,77L0,78L1,78L1,79L2,79L2,80L3,80L3,81L4,81L4,82L5,82L5,83L6,83L6,84L7,84L7,85L8,85L8,86L9,86L9,87L10,87L10,88L11,88L11,89L12,89L12,90L13,90L13,91L14,91L14,92L15,92L15,93L16,93L16,94L17,94L17,95L18,95L18,96L19,96L19,97L20,97L20,98L21,98L21,99L22,99L22,100L23,100L23,101L24,101L24,102L25,102L25,103L26,103L26,104L27,104L27,105L28,105L28,106L29,106L29,107L30,107L30,108L31,108L31,109L32,109L32,110L33,110L33,111L34,111L34,112L35,112L35,113L36,113L36,114L37,114L37,115L38,115L38,116L39,116L39,117L40,117L40,118L41,118L41,119L42,119L42,120L43,120L43,121L44,121L44,122L45,122L45,123L46,123L46,124L47,124L47,125L48,125L48,126L49,126L49,127L50,127L50,128L51,128L51,129L52,129L52,130L53,130L53,131L54,131L54,132L55,132L55,133L56,133L56,134L57,134L57,135L58,135L58,136L59,136L59,137L60,137L60,138L61,138L61,139L62,139L62,140L63,140L63,141L64,141L64,142L65,142L65,143L66,143L66,144L67,144L67,145L68,145L68,146L69,146L69,147L70,147L70,148L71,148L71,149L72,149L72,150L73,150L73,151L74,151L74,152L75,152L75,153L76,153L76,154L77,154L77,155L78,155L78,156L79,156L79,157L80,157L80,158L81,158L81,159L82,159L82,160L83,160L83,161L84,161L84,162L85,162L85,163L86,163L86,164L87,164L87,165L88,165L88,166L89,166L89,167L90,167L90,168L91,168L91,169L92,169L92,170L93,170L93,171L94,171L94,172L95,172L95,173L96,173L96,174L97,174L97,175L98,175L98,176L99,176L99,177L100,177L100,178L101,178L101,179L102,179L102,180L103,180L103,181L104,181L104,182L105,182L105,183L106,183L106,184L107,184L107,185L108,185L108,186L109,186L109,187L110,187L110,188L111,188L111,189L112,189L112,190L113,190L113,191L114,191L114,192L115,192L115,193L116,193L116,194L117,194L117,195L118,195L118,196L119,196L119,197L120,197L120,198L121,198L121,199L122,199L122,200L123,200L123,201L124,201L124,202L125,202L125,203L126,203L126,204L127,204L127,205L128,205L128,206L129,206L129,207L130,207L130,208L131,208L131,209L132,209L132,210L133,210L133,211L134,211L134,212L135,212L135,213L136,213L136,214L137,214L137,215L138,215L138,216L139,216L139,217L140,217L140,218L141,218L141,219L142,219L142,220L143,220L143,221L144,221L144,222L145,222L145,223L146,223L146,224L147,224L147,225L148,225L148,226L149,226L149,227L150,227L150,228L151,228L151,229L152,229L152,230L153,230L153,231L154,231L154,232L155,232L155,233L156,233L156,234L157,234L157,235L158,235L158,236L159,236L159,237L160,237L160,238L161,238L161,239L162,239L162,240L163,240L163,241L164,241L164,242L165,242L165,243L166,243L166,244L167,244L167,245L168,245L168,246L169,246L169,247L170,247L170,248L171,248L171,249L172,249L172,250L173,250L173,251L174,251L174,252L175,252L175,253L176,253L176,254L177,254L177,255L178,255L178,256L179,256L179,257L180,257L180,258L181,258L181,259L182,259L182,260L183,260L183,261L184,261L184,262L185,262L185,263L186,263L186,264L187,264L187,265L188,265L188,266L189,266L189,267L190,267L190,268L191,268L191,269L192,269L192,270L193,270L193,271L194,271L194,272L195,272L195,273L196,273L196,274L197,274L197,275L198,275L198,276L199,276L199,277L200,277L200,278L201,278L201,279L202,279L202,280L203,280L203,281L204,281L204,282L205,282L205,283L206,283L206,284L207,284L207,285L208,285L208,286L209,286L209,287L210,287L210,288L211,288L211,289L212,289L212,290L213,290L213,291L214,291L214,292L215,292L215,293L216,293L216,294L217,294L217,295L218,295L218,296L219,296L219,297L220,297L220,298L221,298L221,299L222,299L222,300L223,300L223,301L224,301L224,302L225,302L225,303L226,303L226,304L227,304L227,305L228,305L228,306L229,306L229,307L230,307L230,308L231,308L231,309L232,309L232,310L233,310L233,311L234,311L234,312L235,312L235,313L236,313L236,314L237,314L237,315L238,315L238,316L239,316L239,317L240,317L240,318L241,318L241,319L242,319L242,320L243,320L243,321L244,321L244,322L245,322L245,323L246,323L246,324L247,324L247,325L248,325L248,326L249,326L249,327L250,327L250,328L251,328L251,329L252,329L252,330L253,330L253,331L254,331L254,332L255,332L255,333L256,333L256,334L257,334L257,335L258,335L258,336L259,336L259,337L260,337L260,338L261,338L261,339L262,339L262,340L263,340L263,341L264,341L264,342L265,342L265,343L266,343L266,344L267,344L267,345L268,345L268,346L269,346L269,347L270,347L270,348L271,348L271,349L272,349L272,350L273,350L273,351L274,351L274,352L275,352L275,353L276,353L276,354L277,354L277,355L278,355L278,356L279,356L279,357L280,357L280,358L281,358L281,359L282,359L282,360L283,360L283,359L284,358L285,358L286,357L287,356L288,356L289,355L290,354L291,354L292,353L293,352L294,352L295,351L296,350L297,350L298,349L299,348L300,348L301,347L302,346L303,346L304,345L305,344L306,344L307,343L308,342L309,342L310,341L311,340L312,340L313,339L314,338L315,338L316,337L317,336L318,336L319,335L320,334L321,334L322,333L323,332L324,332L325,331L326,330L327,330L328,329L329,328L330,328L331,327L332,326L333,326L334,325L335,324L336,324L337,323L338,322L339,322L340,321L341,320L342,320L343,319L344,318L345,318L346,317L347,316L348,316L349,315L350,314L351,314L352,313L353,312L354,312L355,311L356,310L357,310L358,309L359,308L360,308L360,307L359,307L359,306L358,306L358,305L357,305L357,304L356,304L356,303L355,303L355,302L354,302L354,301L353,301L353,300L352,300L352,299L351,299L351,298L350,298L350,297L349,297L349,296L348,296L348,295L347,295L347,294L346,294L346,293L345,293L345,292L344,292L344,291L343,291L343,290L342,290L342,289L341,289L341,288L340,288L340,287L339,287L339,286L338,286L338,285L337,285L337,284L336,284L336,283L335,283L335,282L334,282L334,281L333,281L333,280L332,280L332,279L331,279L331,278L330,278L330,277L329,277L329,276L328,276L328,275L327,275L327,274L326,274L326,273L325,273L325,272L324,272L324,271L323,271L323,270L322,270L322,269L321,269L321,268L320,268L320,267L319,267L319,266L318,266L318,265L317,265L317,264L316,264L316,263L315,263L315,262L314,262L314,261L313,261L313,260L312,260L312,259L311,259L311,258L310,258L310,257L309,257L309,256L308,256L308,255L307,255L307,254L306,254L306,253L305,253L305,252L304,252L304,251L303,251L303,250L302,250L302,249L301,249L301,248L300,248L300,247L299,247L299,246L298,246L298,245L297,245L297,244L296,244L296,243L295,243L295,242L294,242L294,241L293,241L293,240L292,240L292,239L291,239L291,238L290,238L290,237L289,237L289,236L288,236L288,235L287,235L287,234L286,234L286,233L285,233L285,232L284,232L284,231L283,231L283,230L282,230L282,229L281,229L281,228L280,228L280,227L279,227L279,226L278,226L278,225L277,225L277,224L276,224L276,223L275,223L275,222L274,222L274,221L273,221L273,220L272,220L272,219L271,219L271,218L270,218L270,217L269,217L269,216L268,216L268,215L267,215L267,214L266,214L266,213L265,213L265,212L264,212L264,211L263,211L263,210L262,210L262,209L261,209L261,208L260,208L260,207L259,207L259,206L258,206L258,205L257,205L257,204L256,204L256,203L255,203L255,202L254,202L254,201L253,201L253,200L252,200L252,199L251,199L251,198L250,198L250,197L249,197L249,196L248,196L248,195L247,195L247,194L246,194L246,193L245,193L245,192L244,192L244,191L243,191L243,190L242,190L242,189L241,189L241,188L240,188L240,187L239,187L239,186L238,186L238,185L237,185L237,184L236,184L236,183L235,183L235,182L234,182L234,181L233,181L233,180L232,180L232,179L231,179L231,178L230,178L230,177L229,177L229,176L228,176L228,175L227,175L227,174L226,174L226,173L225,173L225,172L224,172L224,171L223,171L223,170L222,170L222,169L221,169L221,168L220,168L220,167L219,167L219,166L218,166L218,165L217,165L217,164L216,164L216,163L215,163L215,162L214,162L214,161L213,161L213,160L212,160L212,159L211,159L211,158L210,158L210,157L209,157L209,156L208,156L208,155L207,155L207,154L206,154L206,153L205,153L205,152L204,152L204,151L203,151L203,150L202,150L202,149L201,149L201,148L200,148L200,147L199,147L199,146L198,146L198,145L197,145L197,144L196,144L196,143L195,143L195,142L194,142L194,141L193,141L193,140L192,140L192,139L191,139L191,138L190,138L190,137L189,137L189,136L188,136L188,135L187,135L187,134L186,134L186,133L185,133L185,132L184,132L184,131L183,131L183,130L182,130L182,129L181,129L181,128L180,128L180,127L179,127L179,126L178,126L178,125L177,125L177,124L176,124L176,123L175,123L175,122L174,122L174,121L173,121L173,120L172,120L172,119L171,119L171,118L170,118L170,117L169,117L169,116L168,116L168,115L167,115L167,114L166,114L166,113L165,113L165,112L164,112L164,111L163,111L163,110L162,110L162,109L161,109L161,108L160,108L160,107L159,107L159,106L158,106L158,105L157,105L157,104L156,104L156,103L155,103L155,102L154,102L154,101L153,101L153,100L152,100L152,99L151,99L151,98L150,98L150,97L149,97L149,96L148,96L148,95L147,95L147,94L146,94L146,93L145,93L145,92L144,92L144,91L143,91L143,90L142,90L142,89L141,89L141,88L140,88L140,87L139,87L139,86L138,86L138,85L137,85L137,84L136,84L136,83L135,83L135,82L134,82L134,81L133,81L133,80L132,80L132,79L131,79L131,78L130,78L130,77L129,77L129,76L128,76L128,75L127,75L127,74L126,74L126,73L125,73L125,72L124,72L124,71L123,71L123,70L122,70L122,69L121,69L121,68L120,68L120,67L119,67L119,66L118,66L118,65L117,65L117,64L116,64L116,63L115,63L115,62L114,62L114,61L113,61L113,60L112,60L112,59L111,59L111,58L110,58L110,57L109,57L109,56L108,56L108,55L107,55L107,54L106,54L106,53L105,53L105,52L104,52L104,51L103,51L103,50L102,50L102,49L101,49L101,48L100,48L100,47L99,47L99,46L98,46L98,45L97,45L97,44L96,44L96,43L95,43L95,42L94,42L94,41L93,41L93,40L92,40L92,39L91,39L91,38L90,38L90,37L89,37L89,36L88,36L88,35L87,35L87,34L86,34L86,33L85,33L85,32L84,32L84,31L83,31L83,30L82,30L82,29L81,29L81,28L80,28L80,27L79,27L79,26L78,26L78,25L77,25L77,24L76,24L76,23L75,23L75,22L74,22L74,21L73,21L73,20L72,20L72,19L71,19L71,18L70,18L70,17L69,17L69,16L68,16L68,15L67,15L67,14L66,14L66,13L65,13L65,12L64,12L64,11L63,11L63,10L62,10L62,9L61,9L61,8L60,8L60,7L59,7L59,6L58,6L58,5L57,5L57,4L56,4L56,3L55,3L55,2L54,2L54,1L53,1L53,0L89,0L89,1L90,1L90,2L91,2L91,3L92,3L92,4L93,4L93,5L94,5L94,6L95,6L95,7L96,7L96,8L97,8L97,9L98,9L98,10L99,10L99,11L100,11L100,12L101,12L101,13L102,13L102,14L103,14L103,15L104,15L104,16L105,16L105,17L106,17L106,18L107,18L107,19L108,19L108,20L109,20L109,21L110,21L110,22L111,22L111,23L112,23L112,24L113,24L113,25L114,25L114,26L115,26L115,27L116,27L116,28L117,28L117,29L118,29L118,30L119,30L119,31L120,31L120,32L121,32L121,33L122,33L122,34L123,34L123,35L124,35L124,36L125,36L125,37L126,37L126,38L127,38L127,39L128,39L128,40L129,40L129,41L130,41L130,42L131,42L131,43L132,43L132,44L133,44L133,45L134,45L134,46L135,46L135,47L136,47L136,48L137,48L137,49L138,49L138,50L139,50L139,51L140,51L140,52L141,52L141,53L142,53L142,54L143,54L143,55L144,55L144,56L145,56L145,57L146,57L146,58L147,58L147,59L148,59L148,60L149,60L149,61L150,61L150,62L151,62L151,63L152,63L152,64L153,64L153,65L154,65L154,66L155,66L155,67L156,67L156,68L157,68L157,69L158,69L158,70L159,70L159,71L160,71L160,72L161,72L161,73L162,73L162,74L163,74L163,75L164,75L164,76L165,76L165,77L166,77L166,78L167,78L167,79L168,79L168,80L169,80L169,81L170,81L170,82L171,82L171,83L172,83L172,84L173,84L173,85L174,85L174,86L175,86L175,87L176,87L176,88L177,88L177,89L178,89L178,90L179,90L179,91L180,91L180,92L181,92L181,93L182,93L182,94L183,94L183,95L184,95L184,96L185,96L185,97L186,97L186,98L187,98L187,99L188,99L188,100L189,100L189,101L190,101L190,102L191,102L191,103L192,103L192,104L193,104L193,105L194,105L194,106L195,106L195,107L196,107L196,108L197,108L197,109L198,109L198,110L199,110L199,111L200,111L200,112L201,112L201,113L202,113L202,114L203,114L203,115L204,115L204,116L205,116L205,117L206,117L206,118L207,118L207,119L208,119L208,120L209,120L209,121L210,121L210,122L211,122L211,123L212,123L212,124L213,124L213,125L214,125L214,126L215,126L215,127L216,127L216,128L217,128L217,129L218,129L218,130L219,130L219,131L220,131L220,132L221,132L221,133L222,133L222,134L223,134L223,135L224,135L224,136L225,136L225,137L226,137L226,138L227,138L227,139L228,139L228,140L229,140L229,141L230,141L230,142L231,142L231,143L232,143L232,144L233,144L233,145L234,145L234,146L235,146L235,147L236,147L236,148L237,148L237,149L238,149L238,150L239,150L239,151L240,151L240,152L241,152L241,153L242,153L242,154L243,154L243,155L244,155L244,156L245,156L245,157L246,157L246,158L247,158L247,159L248,159L248,160L249,160L249,161L250,161L250,162L251,162L251,163L252,163L252,164L253,164L253,165L254,165L254,166L255,166L255,167L256,167L256,168L257,168L257,169L258,169L258,170L259,170L259,171L260,171L260,172L261,172L261,173L262,173L262,174L263,174L263,175L264,175L264,176L265,176L265,177L266,177L266,178L267,178L267,179L268,179L268,180L269,180L269,181L270,181L270,182L271,182L271,183L272,183L272,184L273,184L273,185L274,185L274,186L275,186L275,187L276,187L276,188L277,188L277,189L278,189L278,190L279,190L279,191L280,191L280,192L281,192L281,193L282,193L282,194L283,194L283,195L284,195L284,196L285,196L285,197L286,197L286,198L287,198L287,199L288,199L288,200L289,200L289,201L290,201L290,202L291,202L291,203L292,203L292,204L293,204L293,205L294,205L294,206L295,206L295,207L296,207L296,208L297,208L297,209L298,209L298,210L299,210L299,211L300,211L300,212L301,212L301,213L302,213L302,214L303,214L303,215L304,215L304,216L305,216L305,217L306,217L306,218L307,218L307,219L308,219L308,220L309,220L309,221L310,221L310,222L311,222L311,223L312,223L312,224L313,224L313,225L314,225L314,226L315,226L315,227L316,227L316,228L317,228L317,229L318,229L318,230L319,230L319,231L320,231L320,232L321,232L321,233L322,233L322,234L323,234L323,235L324,235L324,236L325,236L325,237L326,237L326,238L327,238L327,239L328,239L328,240L329,240L329,241L330,241L330,242L331,242L331,243L332,243L332,244L333,244L333,245L334,245L334,246L335,246L335,247L336,247L336,248L337,248L337,249L338,249L338,250L339,250L339,251L340,251L340,252L341,252L341,253L342,253L342,254L343,254L343,255L344,255L344,256L345,256L345,257L346,257L346,258L347,258L347,259L348,259L348,260L349,260L349,261L350,261L350,262L351,262L351,263L352,263L352,264L353,264L353,265L354,265L354,266L355,266L355,267L356,267L356,268L357,268L357,269L358,269L358,270L359,270L359,271L360,271L360,70L359,70L359,69L358,69L358,68L357,68L357,67L356,67L356,66L355,66L355,65L354,65L354,64L353,64L353,63L352,63L352,62L351,62L351,61L350,61L350,60L349,60L349,59L348,59L348,58L347,58L347,57L346,57L346,56L345,56L345,55L344,55L344,54L343,54L343,53L342,53L342,52L341,52L341,51L340,51L340,50L339,50L339,49L338,49L338,48L337,48L337,47L336,47L336,46L335,46L335,45L334,45L334,44L333,44L333,43L332,43L332,42L331,42L331,41L330,41L330,40L329,40L329,39L328,39L328,38L327,38L327,37L326,37L326,36L325,36L325,35L324,35L324,34L323,34L323,33L322,33L322,32L321,32L321,31L320,31L320,30L319,30L319,29L318,29L318,28L317,28L317,27L316,27L316,26L315,26L315,25L314,25L314,24L313,24L313,23L312,23L312,22L311,22L311,21L310,21L310,20L309,20L309,19L308,19L308,18L307,18L307,17L306,17L306,16L305,16L305,15L304,15L304,14L303,14L303,13L302,13L302,12L301,12L301,11L300,11L300,10L299,10L299,9L298,9L298,8L297,8L297,7L296,7L296,6L295,6L295,5L294,5L294,4L293,4L293,3L292,3L292,2L291,2L291,1L290,1L290,0L266,0L266,1L265,1L265,2L264,2L264,3L263,3L263,4L262,4L262,5L261,5L261,6L260,6L260,7L259,7L259,8L258,8L258,9L257,9L257,10L256,10L256,11L255,11L255,12L254,12L254,13L253,13L253,14L252,14L252,15L251,15L251,16L250,16L250,17L249,17L249,18L248,18L248,19L247,19L247,20L246,20L246,21L245,21L245,22L244,22L244,23L243,23L243,24L242,24L242,25L241,25L241,26L240,26L240,27L239,27L239,28L238,28L238,29L237,29L237,30L236,30L236,31L235,31L235,32L234,32L234,33L233,33L233,34L232,34L232,35L231,35L231,36L230,36L230,37L229,37L229,38L228,38L228,39L227,39L227,40L226,40L226,41L225,41L225,42L224,42L224,43L223,43L223,44L222,44L222,45L221,45L221,46L220,46L220,47L219,47L219,48L218,48L218,49L217,49L217,50L216,50L216,51L215,51L215,52L214,52L214,53L213,53L213,54L212,54L212,55L211,55L211,56L210,56L210,57L209,57L209,58L208,58L208,59L207,59L207,60L206,60L206,61L205,61L205,62L204,62L204,63L203,63L203,64L202,64L202,65L201,65L201,66L200,66L200,67L199,67L199,68L198,68L198,69L197,69L197,70L196,70L196,71L195,71L195,72L194,72L194,73L193,73L193,74L192,74L192,75L191,75L191,76L190,76L190,77L189,77L189,78L188,78L188,79L187,79L187,80L186,80L186,81L185,81L185,82L184,82L184,83L183,83L183,84L182,84L182,85L181,85L181,86L180,86L180,87L179,87L179,88L178,88L178,89L177,89L177,90L176,90L176,91L175,91L175,92L174,92L174,93L173,93L173,94L172,94L172,95L171,95L171,96L170,96L170,97L169,97L169,98L168,98L168,99L167,99L167,100L166,100L166,101L165,101L165,102L164,102L164,103L163,103L163,104L162,104L162,105L161,105L161,106L160,106L160,107L159,107L159,108L158,108L158,109L157,109L157,110L156,110L156,111L155,111L155,112L154,112L154,113L153,113L153,114L152,114L152,115L151,115L151,116L150,116L150,117L149,117L149,118L148,118L148,119L147,119L147,120L146,120L146,121L145,121L145,122L144,122L144,123L143,123L143,124L142,124L142,125L141,125L141,126L140,126L140,127L139,127L139,128L138,128L138,129L137,129L137,130L136,130L136,131L135,131L135,132L134,132L134,133L133,133L133,134L132,134L132,135L131,135L131,136L130,136L130,137L129,137L129,138L128,138L128,139L127,139L127,140L126,140L126,141L125,141L125,142L124,142L124,143L123,143L123,144L122,144L122,145L121,145L121,146L120,146L120,147L119,147L119,148L118,148L118,149L117,149L117,150L116,150L116,151L115,151L115,152L114,152L114,153L113,153L113,154L112,154L112,155L111,155L111,156L110,156L110,157L109,157L109,158L108,158L108,159L107,159L107,160L106,160L106,161L105,161L105,162L104,162L104,163L103,163L103,164L102,164L102,165L101,165L101,166L100,166L100,167L99,167L99,168L98,168L98,169L97,169L97,170L96,170L96,171L95,171L95,172L94,172L94,173L93,173L93,174L92,174L92,175L91,175L91,176L90,176L90,177L89,177L89,103L88,103L88,102L87,102L87,101L86,101L86,100L85,100L85,99L84,99L84,98L83,98L83,97L82,97L82,96L81,96L81,95L80,95L80,94L79,94L79,93L78,93L78,92L77,92L77,91L76,91L76,90L75,90L75,89L74,89L74,88L73,88L73,87L72,87L72,86L71,86L71,85L70,85L70,84L69,84L69,83L68,83L68,82L67,82L67,81L66,81L66,80L65,80L65,79L64,79L64,78L63,78L63,77L62,77L62,76L61,76L61,75L60,75L60,74L59,74L59,73L58,73L58,72L57,72L57,71L56,71L56,70L55,70L55,69L54,69L54,68L53,68L53,67L52,67L52,66L51,66L51,65L50,65L50,64L49,64L49,63L48,63L48,62L47,62L47,61L46,61L46,60L45,60L45,59L44,59L44,58L43,58L43,57L42,57L42,56L41,56L41,55L40,55L40,54L39,54L39,53L38,53L38,52L37,52L37,51L36,51L36,50L35,50L35,49L34,49L34,48L33,48L33,47L32,47L32,46L31,46L31,45L30,45L30,44L29,44L29,43L28,43L28,42L27,42L27,41L26,41L26,40L25,40L25,39L24,39L24,38L23,38L23,37L22,37L22,36L21,36L21,35L20,35L20,34L19,34L19,33L18,33L18,32L17,32L17,31L16,31L16,30L15,30L15,29L14,29L14,28L13,28L13,27L12,27L12,26L11,26L11,25L10,25L10,24L9,24L9,23L8,23L8,22L7,22L7,21L6,21L6,20L5,20L5,19L4,19L4,18L3,18L3,17L2,17L2,16L1,16L1,15L0,15L0,63L1,63L2,63L3,63L4,63L5,63L6,63L7,63L8,63L9,63L10,63L11,63L12,63L13,63L14,63L15,63L16,63L17,63L18,63L19,63L20,63L21,63L22,63L23,63L24,63L25,63L26,63L27,63L28,63L29,63L30,63L31,63L32,63L33,63L34,63L35,63L36,63L37,63L38,63L39,63L40,63L41,63L42,63L43,63L44,63L45,63L46,63L47,63L48,63L49,63L50,63L51,63L52,63L53,63L54,63L55,63L56,63L57,63L58,63L59,63L60,63L61,63L62,63L63,63L64,63L65,63L66,63L67,63L68,63L69,63L70,63L71,63L72,63L73,63L74,63L75,63L76,63L77,63L78,63L79,63L80,63L81,63L82,63L83,63L84,63L85,63L86,63L87,63L88,63L89,63Z";

const WorldMap: React.FC<WorldMapProps> = ({ servers, selectedServer, connectionStatus, onSelect }) => {
  const width = 360;
  const height = 180;
  
  // A simplified Mercator projection
  const project = (lat: number, lng: number) => {
    const x = (lng + 180) * (width / 360);
    const rad = lat * Math.PI / 180;
    const mercN = Math.log(Math.tan((Math.PI / 4) + (rad / 2)));
    const y = (height / 2) - (width * mercN / (2 * Math.PI));
    return { x, y };
  };

  const isInteractive = connectionStatus === 'disconnected';
  const homeLocation = { lat: 38.9637, lng: -95.7129 }; // Approx center of US
  const homeCoords = project(homeLocation.lat, homeLocation.lng);

  let selectedCoords = null;
  if (selectedServer && selectedServer.country !== 'Automatic') {
    selectedCoords = project(selectedServer.lat, selectedServer.lng);
  }

  return (
    <div className="my-4 aspect-video w-full rounded-lg bg-dark-bg p-2 border border-dark-border overflow-hidden">
      <svg viewBox={`0 0 ${width} ${height}`} className="w-full h-full">
        <defs>
          <filter id="glow">
            <feGaussianBlur stdDeviation="1.5" result="coloredBlur" />
            <feMerge>
              <feMergeNode in="coloredBlur" />
              <feMergeNode in="SourceGraphic" />
            </feMerge>
          </filter>
        </defs>

        <path d={worldPath} fill="#2D2D2D" stroke="#121212" strokeWidth="0.5" />
        
        {/* Connection Line */}
        {connectionStatus === 'connected' && selectedCoords && (
          <path
            d={`M ${homeCoords.x} ${homeCoords.y} Q ${(homeCoords.x + selectedCoords.x) / 2} ${(homeCoords.y + selectedCoords.y) / 2 - 30} ${selectedCoords.x} ${selectedCoords.y}`}
            stroke="#00FF7F"
            strokeWidth="1"
            fill="none"
            strokeDasharray="2 2"
            filter="url(#glow)"
          >
            <animate
              attributeName="stroke-dashoffset"
              from="8"
              to="0"
              dur="0.5s"
              repeatCount="indefinite"
            />
          </path>
        )}
        
        {/* Server Locations */}
        {servers.map(server => {
          const { x, y } = project(server.lat, server.lng);
          const isSelected = selectedServer?.city === server.city && selectedServer?.country === server.country;
          
          return (
            <g
              key={`${server.city}-${server.country}`}
              transform={`translate(${x}, ${y})`}
              onClick={() => isInteractive && onSelect(server)}
              className={isInteractive ? "cursor-pointer group" : "cursor-default"}
              aria-label={`Select server: ${server.city}, ${server.country}`}
            >
              <title>{`${server.city}, ${server.country}`}</title>
              {isSelected && (
                <circle
                  cx="0"
                  cy="0"
                  r="3"
                  fill="#00BFFF"
                  filter="url(#glow)"
                >
                    <animate
                        attributeName="r"
                        from="3"
                        to="6"
                        dur="1.5s"
                        begin="0s"
                        repeatCount="indefinite"
                    />
                    <animate
                        attributeName="opacity"
                        from="1"
                        to="0"
                        dur="1.5s"
                        begin="0s"
                        repeatCount="indefinite"
                    />
                </circle>
              )}
              <circle
                cx="0"
                cy="0"
                r={isSelected ? "2.5" : "1.5"}
                fill={isSelected ? '#00BFFF' : '#A0A0A0'}
                className="transition-all duration-200 group-hover:fill-white group-hover:r-2"
                stroke="#121212"
                strokeWidth="0.5"
              />
            </g>
          );
        })}

        {/* Home Location */}
        <circle cx={homeCoords.x} cy={homeCoords.y} r="2" fill="#E0E0E0" />

      </svg>
    </div>
  );
};

export default WorldMap;